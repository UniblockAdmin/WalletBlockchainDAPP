{"ast":null,"code":"import React,{useState,useEffect}from'react';import Web3Connect from\"./Web3Connect\";import'../css/Authorization.css';import WalletPanel from'./WalletPanel';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Authorization=()=>{const{web3,contract}=Web3Connect();const[seedPhrase,setSeedPhrase]=useState('');const[authorized,setAuthorized]=useState(false);const[walletAddress,setWalletAddress]=useState('');const[balance,setBalance]=useState(0);const[tokenBalance,setTokenBalance]=useState(0);const handleSeedPhraseChange=e=>{setSeedPhrase(e.target.value);};const handleAuthorization=()=>{setAuthorized(true);};const getAddressByPrivateKey=()=>{const privateKey=document.getElementById(\"data-field\").value;if(!privateKey||privateKey.length!==66){console.error('Invalid private key');return;}const account=web3.eth.accounts.privateKeyToAccount(privateKey);console.log(account.address);setWalletAddress(account.address);return account.address;};// Запрашиваем баланс при авторизации и при изменении адреса кошелька\nuseEffect(()=>{if(authorized){web3.eth.getBalance(walletAddress).then(balance=>{// Баланс в wei\nsetBalance(web3.utils.fromWei(balance,'ether'));}).catch(error=>{console.error('Error fetching balance:',error);});try{web3.eth.getAccounts().then(accounts=>{if(accounts.length===0){console.error(\"No account connected.\");return;}contract.methods.balanceOf(walletAddress).call({from:accounts[0]}).then(result=>{const tokenBalance=web3.utils.fromWei(result.toString(),'ether');setTokenBalance(tokenBalance);console.log(tokenBalance);}).catch(error=>{console.error(\"Error getting token balance:\",error);});});}catch(error){console.error(\"Error getting token balance:\",error);}}},[authorized,walletAddress]);return/*#__PURE__*/_jsxs(\"div\",{className:\"authorization-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041A\\u043E\\u0448\\u0435\\u043B\\u0451\\u043A UniBlockchain (demo)\"}),!authorized?/*#__PURE__*/_jsxs(\"form\",{className:\"authorization-form\",onSubmit:handleAuthorization,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0432\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0440\\u0438\\u0432\\u0430\\u0442\\u043D\\u044B\\u0439 \\u043A\\u043B\\u044E\\u0447 \\u0434\\u043B\\u044F \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0430\\u0446\\u0438\\u0438 \\u0432 \\u043A\\u043E\\u0448\\u0435\\u043B\\u044C\\u043A\\u0435:\",/*#__PURE__*/_jsx(\"input\",{id:\"data-field\",type:\"text\",value:seedPhrase,onChange:handleSeedPhraseChange,required:true})]}),/*#__PURE__*/_jsx(\"button\",{onClick:getAddressByPrivateKey,type:\"submit\",children:\"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0423\\u0441\\u043F\\u0435\\u0448\\u043D\\u0430\\u044F \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F!\"}),/*#__PURE__*/_jsx(WalletPanel,{walletAddress:walletAddress,tokenBalanceObj:tokenBalance}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0411\\u0430\\u043B\\u0430\\u043D\\u0441 ETH: \",balance]})]})]});};export default Authorization;","map":{"version":3,"names":["React","useState","useEffect","Web3Connect","WalletPanel","jsx","_jsx","jsxs","_jsxs","Authorization","web3","contract","seedPhrase","setSeedPhrase","authorized","setAuthorized","walletAddress","setWalletAddress","balance","setBalance","tokenBalance","setTokenBalance","handleSeedPhraseChange","e","target","value","handleAuthorization","getAddressByPrivateKey","privateKey","document","getElementById","length","console","error","account","eth","accounts","privateKeyToAccount","log","address","getBalance","then","utils","fromWei","catch","getAccounts","methods","balanceOf","call","from","result","toString","className","children","onSubmit","id","type","onChange","required","onClick","tokenBalanceObj"],"sources":["C:/Users/olavi/uniblock/WalletBlockchainApp/WalletBlockchainApp/src/Components/Authorization.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Web3Connect from \"./Web3Connect\";\nimport '../css/Authorization.css';\nimport WalletPanel from './WalletPanel';\n\nconst Authorization = () => {\n  const { web3, contract } = Web3Connect();\n\n  const [seedPhrase, setSeedPhrase] = useState('');\n  const [authorized, setAuthorized] = useState(false);\n  const [walletAddress,  setWalletAddress] = useState('');\n  const [balance, setBalance] = useState(0);\n  const [tokenBalance, setTokenBalance] = useState(0);\n\n  const handleSeedPhraseChange = (e) => {\n    setSeedPhrase(e.target.value);\n  };\n\n  const handleAuthorization = () => {\n    setAuthorized(true);\n  };\n\n  const getAddressByPrivateKey = () => {\n    const privateKey = document.getElementById(\"data-field\").value;\n\n    if (!privateKey || privateKey.length !== 66) {\n      console.error('Invalid private key');\n      return;\n    }\n\n    const account = web3.eth.accounts.privateKeyToAccount(privateKey);\n\n    console.log(account.address);\n    setWalletAddress(account.address);\n\n    return account.address;\n  }\n\n  // Запрашиваем баланс при авторизации и при изменении адреса кошелька\n  useEffect(() => {\n    if (authorized) {\n      web3.eth.getBalance(walletAddress)\n        .then(balance => {\n          // Баланс в wei\n          setBalance(web3.utils.fromWei(balance, 'ether'));\n        })\n        .catch(error => {\n          console.error('Error fetching balance:', error);\n        });\n\n      try {\n        web3.eth.getAccounts()\n          .then(accounts => {\n            if (accounts.length === 0) {\n              console.error(\"No account connected.\");\n              return;\n            }\n\n            contract.methods\n              .balanceOf(walletAddress)\n              .call({ from: accounts[0] })\n              .then(result => {\n                const tokenBalance = web3.utils.fromWei(result.toString(), 'ether');\n                setTokenBalance(tokenBalance);\n                console.log(tokenBalance);\n              })\n              .catch(error => {\n                console.error(\"Error getting token balance:\", error);\n              });\n          });\n      } catch (error) {\n        console.error(\"Error getting token balance:\", error);\n      }\n    }\n  }, [authorized, walletAddress]);\n\n  return (\n    <div className=\"authorization-container\">\n      <h2>Кошелёк UniBlockchain (demo)</h2>\n      {!authorized ? (\n        <form className=\"authorization-form\" onSubmit={handleAuthorization}>\n          <label>\n            Пожалуйста, введите приватный ключ для авторизации в кошельке:\n            <input \n              id=\"data-field\"\n              type=\"text\"\n              value={seedPhrase}\n              onChange={handleSeedPhraseChange}\n              required\n            />\n          </label>\n          <button onClick={getAddressByPrivateKey} type=\"submit\">Авторизоваться</button>\n        </form>\n      ) : (\n        <div>\n          <p>Успешная авторизация!</p>\n          <WalletPanel walletAddress={walletAddress} tokenBalanceObj={tokenBalance} />\n          <p>Баланс ETH: {balance}</p> \n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Authorization;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}